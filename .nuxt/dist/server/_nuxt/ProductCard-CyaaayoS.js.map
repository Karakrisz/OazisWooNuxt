{"version":3,"file":"ProductCard-CyaaayoS.js","sources":["../../../../woonuxt_base/app/components/productElements/SaleBadge.vue","../../../../woonuxt_base/app/components/productElements/ProductCard.vue"],"sourcesContent":["<script setup lang=\"ts\">\nconst { t } = useI18n();\nconst { node } = defineProps({\n  node: { type: Object as PropType<Product>, required: true },\n});\n\nconst { storeSettings } = useAppConfig();\n\nconst salePercentage = computed((): string => {\n  if (!node?.rawSalePrice || !node?.rawRegularPrice) return '';\n  const salePrice = parseFloat(node?.rawSalePrice);\n  const regularPrice = parseFloat(node?.rawRegularPrice);\n  return Math.round(((salePrice - regularPrice) / regularPrice) * 100) + ` %`;\n});\n\nconst showSaleBadge = computed(() => node.rawSalePrice && storeSettings.saleBadge !== 'hidden');\n\nconst textToDisplay = computed(() => {\n  if (storeSettings?.saleBadge === 'percent') return salePercentage.value;\n  return t('messages.shop.onSale') ? t('messages.shop.onSale') : 'Sale';\n});\n</script>\n\n<template>\n  <span v-if=\"showSaleBadge\" class=\"red-badge\">{{ textToDisplay }}</span>\n</template>\n\n<style lang=\"postcss\" scoped>\n.red-badge {\n  @apply rounded-md bg-red-400 text-xs text-white tracking-tight px-1.5 leading-6 z-10;\n  background: #000 linear-gradient(0deg, #f87171, #f87171);\n}\n</style>\n","<script setup lang=\"ts\">\nconst route = useRoute();\nconst { storeSettings } = useAppConfig();\nconst props = defineProps({\n  node: { type: Object as PropType<Product>, required: true },\n  index: { type: Number, default: 1 },\n});\n\nconst imgWidth = 220;\nconst imgHeight = Math.round(imgWidth * 1.125);\n\n// example: ?filter=pa_color[green,blue],pa_size[large]\nconst filterQuery = ref(route.query?.filter as string);\nconst paColor = ref(filterQuery.value?.split('pa_color[')[1]?.split(']')[0]?.split(',') || []);\n\n// watch filterQuery\nwatch(\n  () => route.query,\n  () => {\n    filterQuery.value = route.query.filter;\n    paColor.value = filterQuery.value?.split('pa_color[')[1]?.split(']')[0]?.split(',') || [];\n  },\n);\n\nconst mainImage = computed<string>(() => props.node?.image?.producCardSourceUrl || props.node?.image?.sourceUrl || '/images/placeholder.jpg');\nconst imagetoDisplay = computed<string>(() => {\n  if (paColor.value.length) {\n    const activeColorImage = props.node?.variations?.nodes.filter((variation) => {\n      const hasMatchingAttributes = variation.attributes?.nodes.some((attribute) => paColor.value.some((color) => attribute.value.includes(color)));\n      const hasMatchingSlug = paColor.value.some((color) => variation.slug?.includes(color));\n      return hasMatchingAttributes || hasMatchingSlug;\n    });\n    if (activeColorImage?.length) return activeColorImage[0].image?.producCardSourceUrl || activeColorImage[0].image?.sourceUrl || mainImage.value;\n  }\n  return mainImage.value;\n});\n</script>\n\n<template>\n  <div class=\"relative product-card\">\n    <NuxtLink :to=\"`/product/${decodeURIComponent(node.slug)}`\" :title=\"node.name\">\n      <SaleBadge :node=\"node\" class=\"absolute top-2 right-2\" />\n      <NuxtImg\n        v-if=\"imagetoDisplay\"\n        :width=\"imgWidth\"\n        :height=\"imgHeight\"\n        :src=\"imagetoDisplay\"\n        :alt=\"node.image?.altText || node.name || 'Product image'\"\n        :title=\"node.image?.title || node.name\"\n        :loading=\"index <= 3 ? 'eager' : 'lazy'\"\n        :sizes=\"`${imgWidth / 2}px md:${imgWidth}px`\"\n        placeholder\n        placeholder-class=\"blur-xl\" />\n    </NuxtLink>\n    <div class=\"p-2\">\n      <StarRating v-if=\"storeSettings.showReviews\" :rating=\"node.averageRating\" :count=\"node.reviewCount\" />\n      <NuxtLink :to=\"`/product/${decodeURIComponent(node.slug)}`\" :title=\"node.name\">\n        <h2 class=\"mb-2 font-light leading-tight\">{{ node.name }}</h2>\n      </NuxtLink>\n      <ProductPrice class=\"text-sm\" :sale-price=\"node.salePrice\" :regular-price=\"node.regularPrice\" />\n    </div>\n  </div>\n</template>\n\n<style lang=\"postcss\">\n.product-card img {\n  @apply rounded-lg object-top object-cover w-full;\n  aspect-ratio: 1/1.125;\n}\n\n.product-card:hover {\n  h2 {\n    @apply text-primary;\n  }\n}\n</style>\n"],"names":["_c","_b","_a","_d"],"mappings":";;;;;;;;;;;AACM,UAAA,EAAE,MAAM;AACR,UAAA,EAAE,KAAS,IAAA;AAIX,UAAA,EAAE,kBAAkB;AAEpB,UAAA,iBAAiB,SAAS,MAAc;AAC5C,UAAI,EAAC,6BAAM,iBAAgB,EAAC,6BAAM,iBAAwB,QAAA;AACpD,YAAA,YAAY,WAAW,6BAAM,YAAY;AACzC,YAAA,eAAe,WAAW,6BAAM,eAAe;AACrD,aAAO,KAAK,OAAQ,YAAY,gBAAgB,eAAgB,GAAG,IAAI;AAAA,IAAA,CACxE;AAED,UAAM,gBAAgB,SAAS,MAAM,KAAK,gBAAgB,cAAc,cAAc,QAAQ;AAExF,UAAA,gBAAgB,SAAS,MAAM;AACnC,WAAI,+CAAe,eAAc,UAAW,QAAO,eAAe;AAClE,aAAO,EAAE,sBAAsB,IAAI,EAAE,sBAAsB,IAAI;AAAA,IAAA,CAChE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZD,MAAM,WAAW;;;;;;;;;;AAPjB,UAAM,QAAQ;AACR,UAAA,EAAE,kBAAkB;AAC1B,UAAM,QAAQ;AAMd,UAAM,YAAY,KAAK,MAAM,WAAW,KAAK;AAG7C,UAAM,cAAc,KAAI,WAAM,UAAN,mBAAa,MAAgB;AACrD,UAAM,UAAU,MAAI,6BAAY,UAAZ,mBAAmB,MAAM,aAAa,OAAtC,mBAA0C,MAAM,KAAK,OAArD,mBAAyD,MAAM,SAAQ,CAAA,CAAE;AAG7F;AAAA,MACE,MAAM,MAAM;AAAA,MACZ,MAAM;;AACQ,oBAAA,QAAQ,MAAM,MAAM;AAChC,gBAAQ,UAAQA,OAAAC,OAAAC,MAAA,YAAY,UAAZ,gBAAAA,IAAmB,MAAM,aAAa,OAAtC,gBAAAD,IAA0C,MAAM,KAAK,OAArD,gBAAAD,IAAyD,MAAM,SAAQ;MACzF;AAAA,IAAA;AAGI,UAAA,YAAY,SAAiB;;AAAM,eAAAC,OAAAC,MAAA,MAAM,SAAN,gBAAAA,IAAY,UAAZ,gBAAAD,IAAmB,0BAAuBE,OAAAH,MAAA,MAAM,SAAN,gBAAAA,IAAY,UAAZ,gBAAAG,IAAmB,cAAa;AAAA,KAAyB;AACtI,UAAA,iBAAiB,SAAiB,MAAM;;AACxC,UAAA,QAAQ,MAAM,QAAQ;AACxB,cAAM,oBAAmBF,OAAAC,MAAA,MAAM,SAAN,gBAAAA,IAAY,eAAZ,gBAAAD,IAAwB,MAAM,OAAO,CAAC,cAAc;;AAC3E,gBAAM,yBAAwBC,MAAA,UAAU,eAAV,gBAAAA,IAAsB,MAAM,KAAK,CAAC,cAAc,QAAQ,MAAM,KAAK,CAAC,UAAU,UAAU,MAAM,SAAS,KAAK,CAAC;AACrI,gBAAA,kBAAkB,QAAQ,MAAM,KAAK,CAAC,UAAU;;AAAA,oBAAAA,MAAA,UAAU,SAAV,gBAAAA,IAAgB,SAAS;AAAA,WAAM;AACrF,iBAAO,yBAAyB;AAAA,QAAA;AAElC,YAAI,qDAAkB,OAAe,UAAAF,MAAA,iBAAiB,CAAC,EAAE,UAApB,gBAAAA,IAA2B,0BAAuBG,MAAA,iBAAiB,CAAC,EAAE,UAApB,gBAAAA,IAA2B,cAAa,UAAU;AAAA,MAC3I;AACA,aAAO,UAAU;AAAA,IAAA,CAClB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}