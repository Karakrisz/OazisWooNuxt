import{_ as M}from"./ux_Vzo0s.js";import{_ as S}from"./DBjo1zSi.js";import{d as B,N as C,v as H,O as U,s as j,K as i,m as D,o as u,c as b,g as e,a as r,t,h as p,b as a,L as $,w as x,e as L,f as y,T as K,i as z,j as A,l as O,a3 as W,a4 as F,D as V}from"./CVb3yudB.js";const w=n=>(W("data-v-538b7f47"),n=n(),F(),n),G={class:"max-w-lg mx-auto my-16 min-h-[600px] lg:my-24"},J={class:"flex flex-col items-center"},Q={class:"text-xl font-semibold lg:text-3xl"},X={for:"password",class:"mb-4"},Y=w(()=>e("span",{class:"text-red-500"},"*",-1)),Z=w(()=>e("br",null,null,-1)),ss={for:"confirmPassword",class:"mb-4"},es=w(()=>e("span",{class:"text-red-500"},"*",-1)),os=w(()=>e("br",null,null,-1)),ts={key:0,class:"text-sm mb-4"},as=["innerHTML"],rs={class:"flex items-center justify-center gap-4 mt-4 text-lg"},ns={class:"my-8 text-center cursor-pointer"},ls=B({__name:"ResetPassword",setup(n){const{t:l}=C(),g=H(),P=U(),{viewer:I,resetPasswordWithKey:R,loginUser:T}=j(),c=i(""),d=i(""),m=i(""),h=i(!1),_=i(!1),q=async()=>{try{if(m.value="",_.value=!1,h.value=!0,c.value!==d.value)throw new Error(l("messages.error.passwordMismatch"));const s={key:P.query.key,login:P.query.login,password:c.value};if(!s.key||!s.login)throw _.value=!0,new Error(l("messages.error.invalidPasswordResetLink"));const o=await R(s);if(!o.success)throw _.value=!0,new Error(o.error);if(I.value){const f=await T({username:s.login,password:s.password});if(!f.success)throw new Error(f.error)}g.push("/my-account")}catch(s){m.value=s.message||l("messages.error.general")}finally{h.value=!1}};return D({title:l("messages.account.resetPassword")}),(s,o)=>{const f=M,k=S,N=A,E=O;return u(),b("div",G,[e("div",J,[r(f,{class:"mb-6 scale-125"}),e("h1",Q,t(s.$t("messages.account.resetPassword")),1)]),e("form",{class:"mt-6 flex flex-col",onSubmit:z(q,["prevent"])},[e("label",X,[p(t(s.$t("messages.account.newPassword"))+" ",1),Y,Z,r(k,{id:"password",className:" border rounded-lg w-full p-3 px-4 bg-white",modelValue:a(c),"onUpdate:modelValue":o[0]||(o[0]=v=>$(c)?c.value=v:null),placeholder:"New Password",required:!0},null,8,["modelValue"])]),e("label",ss,[p(t(s.$t("messages.account.confirmNewPassword"))+" ",1),es,os,r(k,{id:"confirmPassword",className:"border rounded-lg w-full p-3 px-4 bg-white",modelValue:a(d),"onUpdate:modelValue":o[1]||(o[1]=v=>$(d)?d.value=v:null),placeholder:"Confirm Password",required:!0},null,8,["modelValue"])]),r(K,{name:"scale-y",mode:"out-in"},{default:x(()=>[a(m)?(u(),b("div",ts,[e("span",{class:"text-red-500",innerHTML:a(m)},null,8,as),a(_)?(u(),L(N,{key:0,class:"underline cursor-pointer pl-1",to:"/my-account?action=forgotPassword"},{default:x(()=>[p(t(s.$t("messages.account.requestNewLink")),1)]),_:1})):y("",!0)])):y("",!0)]),_:1}),e("button",rs,[a(h)?(u(),L(E,{key:0,stroke:"4",size:"16",color:"#fff"})):y("",!0),e("span",null,t(s.$t("messages.account.resetPassword")),1)])],32),e("div",ns,[r(N,{to:"/my-account"},{default:x(()=>[p(t(s.$t("messages.account.backToLogin")),1)]),_:1})])])}}}),cs=V(ls,[["__scopeId","data-v-538b7f47"]]),is={},us={class:"container min-h-[600px]"};function ds(n,l){const g=cs;return u(),b("div",us,[r(g)])}const ps=V(is,[["render",ds]]);export{ps as default};
