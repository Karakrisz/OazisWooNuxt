import{_ as D}from"./ux_Vzo0s.js";import{_ as j}from"./DBjo1zSi.js";import{d as z,N as K,O as G,v as J,s as Q,K as h,U as W,I as f,o as l,c as u,g as r,a as x,t as n,b as e,h as d,f as m,B as R,C as U,w as C,T as q,e as X,i as Y,l as Z,a3 as ee,a4 as se,D as te}from"./CVb3yudB.js";const v=w=>(ee("data-v-ae4dae65"),w=w(),se(),w),oe={class:"max-w-lg mx-auto my-16 min-h-[600px] lg:my-24"},ae={class:"flex flex-col items-center"},re={class:"text-xl font-semibold lg:text-3xl"},ne={key:0,class:"my-2 text-center"},le={key:1,class:"my-2 text-center"},ie={key:0,for:"email"},ce=v(()=>r("span",{class:"text-red-500"},"*",-1)),ue=v(()=>r("br",null,null,-1)),de=["placeholder"],me={key:1,class:"text-sm text-gray-500"},ge={key:2},pe={for:"username"},fe=v(()=>r("span",{class:"text-red-500"},"*",-1)),ve=v(()=>r("br",null,null,-1)),_e=["placeholder"],we={for:"password"},ye=v(()=>r("span",{class:"text-red-500"},"*",-1)),he=v(()=>r("br",null,null,-1)),xe=["innerHTML"],be=["innerHTML"],ke={class:"flex items-center justify-center gap-4 mt-4 text-lg"},Pe=z({__name:"LoginAndRegister",setup(w){const{t:a}=K(),b=G(),k=J(),{loginUser:I,isPending:M,registerUser:A,sendResetPasswordEmail:N}=Q(),p=h({email:"",password:"",username:""}),s=h("login"),_=h(""),i=h("");W(b,()=>{b.query.action==="forgotPassword"?s.value="forgotPassword":b.query.action==="register"?s.value="register":s.value="login"},{immediate:!0});const $=async o=>{const{success:t,error:g}=await I(o);switch(g){case"invalid_username":i.value=a("messages.error.invalidUsername");break;case"incorrect_password":i.value=a("messages.error.incorrectPassword");break;default:i.value=g;break}t&&(i.value="",_.value=a("messages.account.loggingIn"))},S=async o=>{if(s.value==="register"){const{success:t,error:g}=await A(o);t?(i.value="",_.value=a("messages.account.accountCreated")+" "+a("messages.account.loggingIn"),setTimeout(()=>{$(o)},2e3)):i.value=g}else s.value==="forgotPassword"?B(o):$(o)},B=async o=>{const{success:t,error:g}=await N(o.email);t?(i.value="",_.value=a("messages.account.ifRegistered")):i.value=g},y=o=>{s.value=o,o==="forgotPassword"?k.push({query:{action:"forgotPassword"}}):o==="register"?k.push({query:{action:"register"}}):k.push({query:{}})},E=f(()=>{if(s.value==="login")return a("messages.account.loginToAccount");if(s.value==="register")return a("messages.account.accountRegister");if(s.value==="forgotPassword")return a("messages.account.forgotPassword")}),F=f(()=>{if(s.value==="login")return a("messages.account.login");if(s.value==="register")return a("messages.account.register");if(s.value==="forgotPassword")return a("messages.account.sendPasswordResetEmail")}),L=f(()=>s.value==="register"?a("messages.billing.email"):a("messages.account.emailOrUsername")),T=f(()=>s.value==="login"?a("messages.account.emailOrUsername"):a("messages.account.username")),V=f(()=>a("messages.account.password")),P=f(()=>({email:L.value,username:T.value,password:V.value}));return(o,t)=>{const g=D,H=j,O=Z;return l(),u("div",oe,[r("div",ae,[x(g,{class:"mb-6 scale-125"}),r("h1",re,n(e(E)),1),e(s)==="login"?(l(),u("div",ne,[d(n(o.$t("messages.account.noAccount"))+" ",1),r("a",{class:"font-semibold cursor-pointer text-primary",onClick:t[0]||(t[0]=c=>y("register"))},n(o.$t("messages.account.accountRegister")),1),d(". ")])):m("",!0),e(s)==="register"?(l(),u("div",le,[d(n(o.$t("messages.account.hasAccount"))+" ",1),r("a",{class:"font-semibold cursor-pointer text-primary",onClick:t[1]||(t[1]=c=>y("login"))},n(o.$t("messages.general.please"))+" "+n(o.$t("messages.account.accountLogin")),1),d(". ")])):m("",!0)]),r("form",{class:"mt-6",onSubmit:t[5]||(t[5]=Y(c=>S(e(p)),["prevent"]))},[e(s)==="register"||e(s)==="forgotPassword"?(l(),u("label",ie,[d(n(e(L))+" ",1),ce,d(),ue,R(r("input",{id:"email","onUpdate:modelValue":t[2]||(t[2]=c=>e(p).email=c),placeholder:e(P).email,type:"text",required:""},null,8,de),[[U,e(p).email]])])):m("",!0),e(s)==="forgotPassword"?(l(),u("p",me,n(o.$t("messages.account.enterEmailOrUsernameForReset")),1)):m("",!0),e(s)!=="forgotPassword"?(l(),u("div",ge,[r("label",pe,[d(n(e(T))+" ",1),fe,d(),ve,R(r("input",{id:"username","onUpdate:modelValue":t[3]||(t[3]=c=>e(p).username=c),placeholder:e(P).username,type:"text",required:""},null,8,_e),[[U,e(p).username]])]),r("label",we,[d(n(e(V))+" ",1),ye,d(),he,x(H,{id:"password",className:"border rounded-lg w-full p-3 px-4 bg-white",modelValue:e(p).password,"onUpdate:modelValue":t[4]||(t[4]=c=>e(p).password=c),placeholder:e(P).password,required:!0},null,8,["modelValue","placeholder"])])])):m("",!0),x(q,{name:"scale-y",mode:"out-in"},{default:C(()=>[e(_)?(l(),u("div",{key:0,class:"my-4 text-sm text-green-500",innerHTML:e(_)},null,8,xe)):m("",!0)]),_:1}),x(q,{name:"scale-y",mode:"out-in"},{default:C(()=>[e(i)?(l(),u("div",{key:0,class:"my-4 text-sm text-red-500",innerHTML:e(i)},null,8,be)):m("",!0)]),_:1}),r("button",ke,[e(M)?(l(),X(O,{key:0,stroke:"4",size:"16",color:"#fff"})):m("",!0),r("span",null,n(e(F)),1)])],32),e(s)==="login"?(l(),u("div",{key:0,class:"my-8 text-center cursor-pointer",onClick:t[6]||(t[6]=c=>y("forgotPassword"))},n(o.$t("messages.account.forgotPassword")),1)):m("",!0),e(s)==="forgotPassword"?(l(),u("div",{key:1,class:"my-8 text-center cursor-pointer",onClick:t[7]||(t[7]=c=>y("login"))},n(o.$t("messages.account.backToLogin")),1)):m("",!0)])}}}),Re=te(Pe,[["__scopeId","data-v-ae4dae65"]]);export{Re as default};
